---
layout: post
title:  "Using NLP to Identify Fake News"
categories: blog assignment
permalink: posts/HW-4
author: Shannan Liu
---



```python
history1
```
```
Epoch 1/20
/usr/local/lib/python3.7/dist-packages/keras/engine/functional.py:559: UserWarning: Input dict contained keys ['text'] which did not match any model input. They will be ignored by the model.
  inputs = self._flatten_to_reference_inputs(inputs)
180/180 [==============================] - 5s 21ms/step - loss: 0.6913 - accuracy: 0.5273 - val_loss: 0.6691 - val_accuracy: 0.9488
Epoch 2/20
180/180 [==============================] - 4s 20ms/step - loss: 0.2260 - accuracy: 0.9013 - val_loss: 0.0677 - val_accuracy: 0.9759
Epoch 3/20
180/180 [==============================] - 4s 20ms/step - loss: 0.0661 - accuracy: 0.9772 - val_loss: 0.0893 - val_accuracy: 0.9636
Epoch 4/20
180/180 [==============================] - 4s 20ms/step - loss: 0.0521 - accuracy: 0.9830 - val_loss: 0.0454 - val_accuracy: 0.9867
Epoch 5/20
180/180 [==============================] - 4s 20ms/step - loss: 0.0453 - accuracy: 0.9848 - val_loss: 0.0387 - val_accuracy: 0.9872
Epoch 6/20
180/180 [==============================] - 4s 20ms/step - loss: 0.0408 - accuracy: 0.9868 - val_loss: 0.0417 - val_accuracy: 0.9872
Epoch 7/20
180/180 [==============================] - 4s 20ms/step - loss: 0.0416 - accuracy: 0.9867 - val_loss: 0.0303 - val_accuracy: 0.9899
Epoch 8/20
180/180 [==============================] - 4s 20ms/step - loss: 0.0399 - accuracy: 0.9873 - val_loss: 0.0304 - val_accuracy: 0.9894
Epoch 9/20
180/180 [==============================] - 4s 20ms/step - loss: 0.0388 - accuracy: 0.9874 - val_loss: 0.0308 - val_accuracy: 0.9899
Epoch 10/20
180/180 [==============================] - 4s 20ms/step - loss: 0.0369 - accuracy: 0.9882 - val_loss: 0.0258 - val_accuracy: 0.9915
Epoch 11/20
180/180 [==============================] - 4s 20ms/step - loss: 0.0403 - accuracy: 0.9873 - val_loss: 0.0355 - val_accuracy: 0.9883
Epoch 12/20
180/180 [==============================] - 4s 20ms/step - loss: 0.0388 - accuracy: 0.9875 - val_loss: 0.0310 - val_accuracy: 0.9899
Epoch 13/20
180/180 [==============================] - 4s 21ms/step - loss: 0.0385 - accuracy: 0.9882 - val_loss: 0.0326 - val_accuracy: 0.9888
Epoch 14/20
180/180 [==============================] - 4s 20ms/step - loss: 0.0282 - accuracy: 0.9918 - val_loss: 0.0629 - val_accuracy: 0.9798
Epoch 15/20
180/180 [==============================] - 4s 20ms/step - loss: 0.0333 - accuracy: 0.9890 - val_loss: 0.0308 - val_accuracy: 0.9892
Epoch 16/20
180/180 [==============================] - 4s 19ms/step - loss: 0.0288 - accuracy: 0.9919 - val_loss: 0.0663 - val_accuracy: 0.9777
Epoch 17/20
180/180 [==============================] - 4s 20ms/step - loss: 0.0284 - accuracy: 0.9911 - val_loss: 0.0402 - val_accuracy: 0.9849
Epoch 18/20
180/180 [==============================] - 5s 25ms/step - loss: 0.0241 - accuracy: 0.9930 - val_loss: 0.1092 - val_accuracy: 0.9584
Epoch 19/20
180/180 [==============================] - 4s 20ms/step - loss: 0.0307 - accuracy: 0.9903 - val_loss: 0.1108 - val_accuracy: 0.9589
Epoch 20/20
180/180 [==============================] - 4s 20ms/step - loss: 0.0324 - accuracy: 0.9900 - val_loss: 0.0277 - val_accuracy: 0.9912
```

```python
history2
```

```
Epoch 1/20
/usr/local/lib/python3.7/dist-packages/keras/engine/functional.py:559: UserWarning: Input dict contained keys ['title'] which did not match any model input. They will be ignored by the model.
  inputs = self._flatten_to_reference_inputs(inputs)
180/180 [==============================] - 8s 38ms/step - loss: 0.4707 - accuracy: 0.7188 - val_loss: 0.1653 - val_accuracy: 0.9272
Epoch 2/20
180/180 [==============================] - 7s 37ms/step - loss: 0.1065 - accuracy: 0.9630 - val_loss: 0.1285 - val_accuracy: 0.9438
Epoch 3/20
180/180 [==============================] - 7s 37ms/step - loss: 0.0666 - accuracy: 0.9763 - val_loss: 0.0581 - val_accuracy: 0.9829
Epoch 4/20
180/180 [==============================] - 7s 38ms/step - loss: 0.0412 - accuracy: 0.9879 - val_loss: 0.0535 - val_accuracy: 0.9858
Epoch 5/20
180/180 [==============================] - 7s 37ms/step - loss: 0.0327 - accuracy: 0.9898 - val_loss: 0.0696 - val_accuracy: 0.9843
Epoch 6/20
180/180 [==============================] - 7s 37ms/step - loss: 0.0333 - accuracy: 0.9888 - val_loss: 0.0560 - val_accuracy: 0.9874
Epoch 7/20
180/180 [==============================] - 8s 42ms/step - loss: 0.0250 - accuracy: 0.9918 - val_loss: 0.0514 - val_accuracy: 0.9874
Epoch 8/20
180/180 [==============================] - 7s 37ms/step - loss: 0.0219 - accuracy: 0.9926 - val_loss: 0.0495 - val_accuracy: 0.9892
Epoch 9/20
180/180 [==============================] - 7s 37ms/step - loss: 0.0244 - accuracy: 0.9925 - val_loss: 0.0486 - val_accuracy: 0.9874
Epoch 10/20
180/180 [==============================] - 7s 37ms/step - loss: 0.0220 - accuracy: 0.9932 - val_loss: 0.0582 - val_accuracy: 0.9825
Epoch 11/20
180/180 [==============================] - 7s 37ms/step - loss: 0.0138 - accuracy: 0.9960 - val_loss: 0.0632 - val_accuracy: 0.9856
Epoch 12/20
180/180 [==============================] - 7s 38ms/step - loss: 0.0094 - accuracy: 0.9978 - val_loss: 0.1017 - val_accuracy: 0.9762
Epoch 13/20
180/180 [==============================] - 7s 37ms/step - loss: 0.0132 - accuracy: 0.9954 - val_loss: 0.0856 - val_accuracy: 0.9789
Epoch 14/20
180/180 [==============================] - 7s 37ms/step - loss: 0.0095 - accuracy: 0.9971 - val_loss: 0.0758 - val_accuracy: 0.9865
Epoch 15/20
180/180 [==============================] - 7s 37ms/step - loss: 0.0191 - accuracy: 0.9934 - val_loss: 0.0810 - val_accuracy: 0.9804
Epoch 16/20
180/180 [==============================] - 7s 37ms/step - loss: 0.0145 - accuracy: 0.9951 - val_loss: 0.0721 - val_accuracy: 0.9858
Epoch 17/20
180/180 [==============================] - 7s 38ms/step - loss: 0.0084 - accuracy: 0.9969 - val_loss: 0.1116 - val_accuracy: 0.9697
Epoch 18/20
180/180 [==============================] - 7s 38ms/step - loss: 0.0172 - accuracy: 0.9940 - val_loss: 0.0765 - val_accuracy: 0.9845
```


```python
history3
```

```
Epoch 1/20
180/180 [==============================] - 40s 59ms/step - loss: 0.0189 - accuracy: 0.9937 - val_loss: 0.0187 - val_accuracy: 0.9946
Epoch 2/20
180/180 [==============================] - 10s 57ms/step - loss: 0.0066 - accuracy: 0.9974 - val_loss: 0.0236 - val_accuracy: 0.9953
Epoch 3/20
180/180 [==============================] - 10s 57ms/step - loss: 0.0044 - accuracy: 0.9987 - val_loss: 0.0093 - val_accuracy: 0.9982
Epoch 4/20
180/180 [==============================] - 10s 58ms/step - loss: 0.0060 - accuracy: 0.9981 - val_loss: 0.0081 - val_accuracy: 0.9973
Epoch 5/20
180/180 [==============================] - 10s 56ms/step - loss: 0.0042 - accuracy: 0.9988 - val_loss: 0.0068 - val_accuracy: 0.9987
Epoch 6/20
180/180 [==============================] - 10s 57ms/step - loss: 0.0038 - accuracy: 0.9986 - val_loss: 0.0066 - val_accuracy: 0.9982
Epoch 7/20
180/180 [==============================] - 10s 57ms/step - loss: 0.0032 - accuracy: 0.9991 - val_loss: 0.0077 - val_accuracy: 0.9984
Epoch 8/20
180/180 [==============================] - 10s 56ms/step - loss: 8.8323e-05 - accuracy: 1.0000 - val_loss: 0.0341 - val_accuracy: 0.9964
Epoch 9/20
180/180 [==============================] - 10s 56ms/step - loss: 0.0085 - accuracy: 0.9974 - val_loss: 0.0116 - val_accuracy: 0.9973
Epoch 10/20
180/180 [==============================] - 10s 56ms/step - loss: 0.0035 - accuracy: 0.9989 - val_loss: 0.0076 - val_accuracy: 0.9982
Epoch 11/20
180/180 [==============================] - 10s 57ms/step - loss: 0.0027 - accuracy: 0.9992 - val_loss: 0.0133 - val_accuracy: 0.9975
Epoch 12/20
180/180 [==============================] - 10s 57ms/step - loss: 0.0019 - accuracy: 0.9993 - val_loss: 0.0111 - val_accuracy: 0.9975
Epoch 13/20
180/180 [==============================] - 10s 56ms/step - loss: 0.0097 - accuracy: 0.9969 - val_loss: 0.0174 - val_accuracy: 0.9957
Epoch 14/20
180/180 [==============================] - 10s 56ms/step - loss: 0.0030 - accuracy: 0.9992 - val_loss: 0.1287 - val_accuracy: 0.9755
Epoch 15/20
180/180 [==============================] - 10s 55ms/step - loss: 0.0033 - accuracy: 0.9988 - val_loss: 0.0130 - val_accuracy: 0.9973
```

## Model eval

```
225/225 [==============================] - 2s 8ms/step - loss: 0.1749 - accuracy: 0.9533

225/225 [==============================] - 3s 14ms/step - loss: 0.1292 - accuracy: 0.9650

225/225 [==============================] - 4s 17ms/step - loss: 0.0151 - accuracy: 0.9969
```
