---
layout: post
title:  "Homework 1"
categories: blog assignment
permalink: posts/HW-1
author: Shannan Liu
---

## Introduction
In this post, I will create interactive data graphics with NOAA climate data.

## Create a database
To begin, let's create a database called "temps" that includes 3 interrelated tables: `temperatures`, `stations`, and `countries`. These tables will contain all of the relevant climate information for us to create interesting interactive data graphics moving forward.

## Extracting data
Now that we have the database "temps," I will create a function that allows us to obtain a pandas dataframe with the temperature readings for the specified country, in a specified date range, for a specified month of the year.

Here is the function
```python
def query_climate_database(country, year_begin,year_end,month):
  conn = sqlite3.connect("/Users/Shannan/Desktop/Uni/2021-22/Spring/PIC 16B/Week 1/temps.db")

  # get station name, year, month, temp measurement
  # from statins in antarctica
  cmd = \
  """
  SELECT S.name, S.latitude, S.longitude, S.country, T.year, T.month, mean(T.temp) avg_temp
  FROM temperatures T
  LEFT JOIN stations S ON T.id = S.id
  WHERE (T.year BETWEEN year_begin AND year_end) AND T.month = month
  """

  df = pd.read_sql_query(cmd, conn)
  conn.close()


```
